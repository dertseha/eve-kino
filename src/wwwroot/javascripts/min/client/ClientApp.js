define("TestController",[],function(){var t=function(t){return function(e){e.testName=t.test}};return{create:t}}),define("3d/ResourceManager",["lib/ccpwgl"],function(t){var e=function(e,n){return t.setResourcePath(e,n),this},n={setResourcePath:e};return n}),define("3d/Helper",["lib/gl-matrix"],function(t){var e=Math.PI/180,n={forward:1,upward:-1,rightward:-1},i={rollClockwise:1,pitchUp:-1,yawRight:1},o={forward:1,upward:1,rightward:-1},a={VIEW_DIRECTION_FORWARD:n.forward,VIEW_DIRECTION_UP:n.upward,VIEW_DIRECTION_RIGHT:n.rightward,VIEW_ROTATION_ROLL_CLOCKWISE:i.rollClockwise,VIEW_ROTATION_PITCH_UP:i.pitchUp,VIEW_ROTATION_YAW_RIGHT:i.yawRight,VIEW_VECTOR_FORWARD:t.vec3.create([0,0,n.forward]),VIEW_VECTOR_UP:t.vec3.create([0,n.upward,0]),VIEW_VECTOR_RIGHT:t.vec3.create([n.rightward,0,0]),MODEL_DIRECTION_FORWARD:o.forward,MODEL_DIRECTION_UP:o.upward,MODEL_DIRECTION_RIGHT:o.rightward,MODEL_VECTOR_FORWARD:t.vec3.create([0,0,o.forward]),MODEL_VECTOR_UP:t.vec3.create([0,o.upward,0]),MODEL_VECTOR_RIGHT:t.vec3.create([o.rightward,0,0]),degreeToRad:function(t){return t*e}};return a}),define("3d/SceneCamera",["lib/gl-matrix","3d/Helper"],function(t,e){var n=function(){function n(e){var n={rawValue:0,quat:t.quat4.identity(),vector:e};return n}this.fov=60,this.nearPlane=1,this.farPlane=1e5,this.pitch=n(e.VIEW_VECTOR_RIGHT),this.roll=n(e.VIEW_VECTOR_FORWARD),this.yaw=n(e.VIEW_VECTOR_UP),this.rotation=t.quat4.identity(),this.position=t.vec3.create(),this.viewOffset=t.vec3.create(),this.projection=t.mat4.create(),this.view=t.mat4.create(),this.updateView=this.calculateView};return n.prototype.nullFunction=function(){},n.prototype.calculateView=function(){t.quat4.identity(this.rotation),t.quat4.multiply(this.roll.quat,this.rotation,this.rotation),t.quat4.multiply(this.pitch.quat,this.rotation,this.rotation),t.quat4.multiply(this.yaw.quat,this.rotation,this.rotation),t.mat4.fromRotationTranslation(this.rotation,this.viewOffset,this.view),t.mat4.translate(this.view,this.position),this.updateView=this.nullFunction},n.prototype.onViewChanged=function(){this.updateView=this.calculateView},n.prototype.getProjection=function(e){return t.mat4.perspective(this.fov,e,this.nearPlane,this.farPlane,this.projection),this.projection},n.prototype.getView=function(){return this.updateView(),this.view},n.prototype.update=function(){},n.prototype.getStateData=function(t){var e=t||{};return e.position=this.getPosition(e.position),e.rotation||(e.rotation=[0,0,0]),e.rotation[0]=this.roll.rawValue,e.rotation[1]=this.pitch.rawValue,e.rotation[2]=this.yaw.rawValue,e},n.prototype.setStateData=function(t){this.setRoll(t.rotation[0]),this.setPitch(t.rotation[1]),this.setYaw(t.rotation[2]),this.setPosition(t.position)},n.prototype.getPosition=function(e){return t.vec3.set(this.position,e||[0,0,0])},n.prototype.setPosition=function(e){t.vec3.set(e,this.position),this.onViewChanged()},n.prototype.changeRotation=function(e,n){e.rawValue!==n&&(e.rawValue=n,t.quat4.fromAngleAxis(n,e.vector,e.quat),this.onViewChanged())},n.prototype.getPitch=function(){return this.pitch.rawValue},n.prototype.setPitch=function(t){this.changeRotation(this.pitch,t)},n.prototype.getRoll=function(){return this.roll.rawValue},n.prototype.setRoll=function(t){this.changeRotation(this.roll,t)},n.prototype.getYaw=function(){return this.yaw.rawValue},n.prototype.setYaw=function(t){this.changeRotation(this.yaw,t)},n}),define("3d/Scene",["lib/ccpwgl","3d/SceneCamera","lib/gl-matrix"],function(t,e){var n=function(){this.camera=new e,t.setCamera(this.camera)};return n.prototype.setBackgroundBox=function(e){this.scene=t.loadScene(e)},n.prototype.getCamera=function(){return this.camera},n.prototype.setPreRenderCallback=function(e){t.onPreRender=e},n}),define("3d/SceneProducer",["lib/ccpwgl","3d/ResourceManager","3d/Scene"],function(t,e,n){var i={},o=function(e){return t.initialize(e,i),new n},a=function(){return e},r={createScene:o,getResourceManager:a};return r}),define("StageManager",[],function(){var t=function(){};return t.prototype.updateStage=function(){},t}),define("Camera",[],function(){var t={getCameraStateData:function(t){return t}},e=function(e){this.sceneCamera=e,this.operator=t,this.lastState=null};return e.getNullOperator=function(){return Object.create(t)},e.prototype.setOperator=function(e){this.operator=e||t},e.prototype.updateFrame=function(){var t=this.sceneCamera,e=t.getStateData(this.lastState),n=this.operator.getCameraStateData(e);t.setStateData(n),this.lastState=e},e}),define("controls/CommandChannel",[],function(){var t=function(t,e,n,i){this.owner=t,this.id=e,this.type=n,this.actions=i,this.resetCommands()};return t.prototype.resetCommands=function(){var t=this;this.commands={},this.actions.forEach(function(e){t.commands[e]=0})},t.prototype.close=function(){this.owner.removeCommandChannel(this.id)},t.prototype.hasAction=function(t){return this.actions.indexOf(t)>=0},t.prototype.setCommandIntensity=function(t,e){this.commands[t]=e},t.prototype.getNewCommands=function(){var t=this.commands;return this.resetCommands(),t},t}),define("controls/InputChannel",[],function(){var t=function(t,e,n){this.owner=t,this.id=e,this.type=n};return t.prototype.close=function(){this.owner.removeInputChannel(this.id)},t.prototype.setIntensity=function(t,e){this.owner.setInputIntensity(this.type,t,e)},t}),define("Director",["controls/CommandChannel","controls/InputChannel"],function(t,e){var n=function(){this.bindings={},this.commandChannels={},this.inputChannels={},this.idCounter=0};return n.prototype.getNextId=function(){return""+this.idCounter++},n.prototype.getInputChannel=function(t){var n=this.getNextId(),i=new e(this,n,t);return this.inputChannels[n]=i,i},n.prototype.removeInputChannel=function(t){delete this.inputChannels[t]},n.prototype.getCommandChannel=function(e,n){var i=this.getNextId(),o=new t(this,i,e,n);return this.commandChannels[i]=o,o},n.prototype.removeCommandChannel=function(t){delete this.commandChannels[t]},n.prototype.getBindings=function(){return this.bindings},n.prototype.addBinding=function(t,e){this.bindings[t.actionName]=[e]},n.prototype.setInputIntensity=function(t,e,n){var i=this,o=function(t){var o=i.bindings[t];o&&o.forEach(function(o){e===o.inputName&&i.setActionIntensity(t,n)})};for(var a in this.bindings)o(a)},n.prototype.setActionIntensity=function(t,e){var n,i;for(n in this.commandChannels)i=this.commandChannels[n],i.hasAction(t)&&i.setCommandIntensity(t,e)},n}),define("CameraOperator",[],function(){var t=["pitchUpDown","rollClockwise","yawRightLeft","moveUpDown","moveForwardBackward","moveRightLeft"],e=function(t){this.commandChannel=t};return e.getActionNames=function(){return t.slice(0)},e.prototype.getCameraStateData=function(t){var e=t,n=this.commandChannel.getNewCommands();return e.rotation[0]+=n.rollClockwise,e.rotation[1]+=n.pitchUpDown,e.rotation[2]+=n.yawRightLeft,e},e}),define("Resources",["StageManager","Camera","Director","CameraOperator"],function(t,e,n,i){var o={StageManager:t,Director:n,Camera:e,CameraOperator:i};return o}),define("controls/Gamepad",["lib/gamepad"],function(){var t=function(){this.listeners=[]};return t.prototype.getRuntimeId=function(){return this.runtimeId},t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.onDeviceDisconnected=function(){this.listeners.forEach(function(t){t.onGamepadDisconnected()})},t.prototype.onControlValueChanged=function(t,e){this.listeners.forEach(function(n){n.onControlValueChanged(t,e)})},t}),define("controls/GamepadApi",["lib/gamepad","controls/Gamepad"],function(t,e){var n=function(){this.lib=new t,this.gamepads={},this.idCounter=0,this.connectionListeners=[]};return n.prototype.init=function(){var e=this;return this.lib.bind(t.Event.CONNECTED,function(t){e.onDeviceConnected(t)}),this.lib.bind(t.Event.DISCONNECTED,function(t){e.onDeviceDisonnected(t)}),this.lib.bind(t.Event.BUTTON_DOWN,function(t){e.onControlValueChanged(t.gamepad.index,t.control,1)}),this.lib.bind(t.Event.BUTTON_UP,function(t){e.onControlValueChanged(t.gamepad.index,t.control,0)}),this.lib.bind(t.Event.AXIS_CHANGED,function(t){e.onControlValueChanged(t.gamepad.index,t.axis,t.value)}),this.lib.init()},n.prototype.getGamepads=function(){var t,e=[];for(t in this.gamepads)e.push(this.gamepads[t]);return e},n.prototype.addGamepadListener=function(t){this.connectionListeners.push(t)},n.prototype.onDeviceConnected=function(t){var n=new e(this.idCounter++);this.gamepads[t.index]=n,this.connectionListeners.forEach(function(t){t.onGamepadConnected(n)})},n.prototype.onDeviceDisonnected=function(t){var e=this.gamepads[t.index];e&&(delete this.gamepads[t.index],e.onDeviceDisconnected(),this.connectionListeners.forEach(function(t){t.onGamepadDisconnected(e)}))},n.prototype.onControlValueChanged=function(t,e,n){var i=this.gamepads[t];i&&i.onControlValueChanged(e,n)},n}),define("ClientApp",["module","angular","TestController","3d/SceneProducer","Resources","controls/GamepadApi"],function(t,e,n,i,o,a){var r=t.config(),s=function(t){var s=e.module("ClientApp",[]);s.controller("TestController",["$scope",n.create(r)]),i.getResourceManager().setResourcePath("res","//web.ccpgamescdn.com/ccpwgl/res/");var c=i.createScene(t);c.setBackgroundBox("res:/dx9/scene/universe/a01_cube.red");var u=c.scene.loadShip("res:/dx9/model/ship/amarr/battleship/ab3/ab3_t1.red",void 0);u.loadBoosters("res:/dx9/model/ship/booster/booster_amarr.red");var h=new o.Camera(c.getCamera()),p=new o.Director,l=p.getCommandChannel("camera",o.CameraOperator.getActionNames()),d=new o.CameraOperator(l),f=p.getInputChannel("gamepad");h.setOperator(d),p.addBinding({actionName:"yawRightLeft"},{inputName:"RIGHT_STICK_X"});var m={onGamepadDisconnected:function(){},onControlValueChanged:function(t,e){f.setIntensity(t,e)}},w=new a;return w.addGamepadListener({onGamepadConnected:function(t){t.addListener(m)},onGamepadDisconnected:function(){}}),w.init(),c.setPreRenderCallback(function(){h.updateFrame()}),[s.name]};return s});